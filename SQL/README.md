# SQL

### Базы дынных
- Самый лучший способ сохранять данные пользователя, на данный момент, - это базы данных. В отличаи от файлов, которые тоже могут сохранять данные вашей программы, базы данных имеют множество преимуществ, а именно:
    - Разрешения - вы можете задать разрешения, по которым пользователи базы могут взаимодействовать с данными
    - Структурированность - данные хранятся не абы как, а в конкретных местах и определенным образом, и база данных дает этому гарантии
    - Легкость работы над данными - чтобы получить какие-то записи из БД, не нужно считывать оттуда все данные. БД дает удобные инструменты для сортировки, фильтровки и обновления данных
    - Защита данных - БД не так уж легко взломать и получить доступ к данным.

### Основные команды (SQLite3)
- Для работы с БД, в Python есть встроенный модуль `sqlite3`, для работы с бд нужно создать подключение и получить курсор:
    ```python
    import sqlite3

    connection = sqlite3.connect("example.db") # создаем соединение
    cursor = connection.cursor() # получаем курсор
    ```
    курсор - это объект, через который мы будем делать операции с БД, касающиеся данных. Соединение - более общая концепция, дающее контроль над всем взаимодействием с БД, а не только над данными.
- Создание таблиц происходит с помощью команды `CREATE TABLE table_name(...);`:
    ```python
    # создаем таблицу со столбцами id, email, name
    cursor.execute("""
        CREATE TABLE users (id, email, name); 
    """)
    connection.commit() # сохраняем
    ```
    Однажды создав таблицу, мы не можем ее создать второй раз. Потому после запуска данных строк кода, их стоит закомментить, чтобы не получать  ошибку.
- Добавление записей делается с помощью команды `INSERT INTO table_name VALUES (...);`:
    ```python
    # добавляем записи пользователей в таблицу
    cursor.execute(
        """INSERT INTO users VALUES (1, "edefe", "alex");"""
    )
    cursor.execute(
        """INSERT INTO users VALUES (2, "edefe1", "vova");"""
    )
    cursor.execute(
        """INSERT INTO users VALUES (3, "edefe2", "bob");"""
    )
    cursor.execute(
        """INSERT INTO users VALUES (5, "edefe3", "alice");"""
    )

    # сохраняем изменения
    connection.commit()
    ```

- Получение данных делается при помощи команды `SELECT ... FROM table_name;`:
    ```python
    # запрос на получение всех данных
    cursor.execute("""
        SELECT * FROM users;
    """)

    # получение запрашиваемых данных
    data = cursor.fetchall()
    ```
    Или можно получать только определенные колонки из таблицы:
    ```python
    # запрос на получение имен
    cursor.execute("""
        SELECT name FROM users;
    """)

    # получение запрашиваемых данных
    data = cursor.fetchall()
    ```
- Можно фильтровать получаемые данные при помощи конструкции `WHERE ...;`:
    ```python
    # запрос на получение всех данных о пользователе с именем bob
    cursor.execute("""
        SELECT * FROM users WHERE name="bob";
    """)

    # получение запрашиваемых данных
    data = cursor.fetchall()
    ```
- Обновление данных происходит с помощью команды `UPDATE table_name SET column_name=value;`, чаще всего нужно еще добавлять условие, т.е. указать, какие именно записи нужно обновить при помощи `WHERE`:
    ```python
    # запрос на обновление email у пользователей с именем bob
    cursor.execute("""
        UPDATE users SET email="qqq" WHERE name="bob";
    """)

    # сохранение изменений
    connection.commit()
    ```
- Удаление данных происходит через команду `DELETE FROM table_name WHERE ...;`, если не написать `WHERE` в конце и не указать условия, то будут удалены все данные из таблицы:
    ```python
    # запрос удаления пользователя с именем bob
    cursor.execute("""
        DELETE FROM users WHERE name="bob";
    """)

    # сохранение изменений
    connection.commit()
    ```
    